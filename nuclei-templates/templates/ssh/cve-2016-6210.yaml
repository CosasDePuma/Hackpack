---
id: cve-2016-6210
info:
  name: User Enumeration in OpenSSH < 7.3
  author: cosasdepuma
  severity: medium
  description: |
    OpenSSH before 7.3, when SHA256 or SHA512 are used for user password hashing, uses BLOWFISH hashing on a static password when the username does not exist, which allows remote attackers to enumerate users by leveraging the timing difference between responses when a large password is provided.
  remediation: |-
    Upgrade to OpenSSH 7.3 or later.  
  reference:
    - http://seclists.org/fulldisclosure/2016/Jul/51
    - https://datatracker.ietf.org/doc/html/rfc4252
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2016-6210
    cwe-id: CWE-208
  metadata:
    verified: true
    max-request: 1
    shodan-query:
      - vuln:CVE-2016-6210
  tags: cosasdepuma,cve,passive,ssh,openssh
javascript:
  - pre-condition: |-
      isPortOpen(Host,Port);
    code: |-
      const max_version = [7,3];
      const m = require("nuclei/ssh");
      const c = m.SSHClient();
      const response = c.ConnectSSHInfoMode(Host, Port);
      if(response.UserAuth.includes("password")) {
      const regex = new RegExp(/OpenSSH_([0-9]+\.[0-9]+(?:\.[0-9]+)?)/);
      const version = regex.exec(response.ServerID.SoftwareVersion);
      if(version && version.length > 1) {
      const splitted_version = version[1].split('.');
      if(splitted_version[0] < max_version[0] 
      || (splitted_version[0] <= max_version[0] && splitted_version[1] < max_version[1]))
      Export(`${response.ServerID.SoftwareVersion.replaceAll('_',' ')} (password)`);
      }
      }
    args:
      Host: "{{Host}}"
      Port: 22
    extractors:
      - type: dsl
        dsl:
          - response
...
